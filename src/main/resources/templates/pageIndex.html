<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>主页</title>
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/index.css" rel="stylesheet">
    <script src="js/jquery-3.2.1.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/index.js"></script>
    <style>
        .navbar-inverse input[type="text"] {
            background: #313131;
            border: none;
            color: #999; }

        .navbar-inverse .navbar-form {
            position: relative; }

        .navbar-form button[type="submit"] {
            background: #313131;
            border: none;
            color: #999;
            position: absolute;
            top: 28%;
            right: 8%; }

        @media (min-width: 768px) {
            .navbar-form button[type="submit"] {
                top: 15%; } }
        .item img {
            width: 100%; }
    </style>
</head>
<body>
<!--导航-->
<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container">
        <div class="navbar-header">
            <button class="navbar-toggle" data-toggle="collapse"
                    data-target="#response-collapse">
                <span class="icon-bar"></span> <span class="icon-bar"></span> <span
                    class="icon-bar"></span>
            </button>
            <a href="backHome" class="navbar-brand"><strong>毕业设计</strong></a>
        </div>
        <div class="collapse navbar-collapse" id="response-collapse">
            <ul class="nav navbar-nav" id="nav">
                <li class="itemdisplay" style="display: none"><a href="toaddItem">题库</a></li>
                <li><a href="mockExam" id="mockExam">模拟考试</a></li>
                <li><a href="practice">随机练习</a></li>
                <li><a href="practice2">顺序练习</a></li>
                <li><a href="#">联系我们</a></li>
            </ul>
            <form action="" class="navbar-form navbar-left">
                <input type="text" placeholder="搜索" class="form-control">
                <button type="submit">
                    <span class="glyphicon glyphicon-search"></span>
                </button>
            </form>
            <div class="profile navbar-right">
                <ul class="nav navbar-nav">
                    <li class="nowuser" style="display: none;"><a href="#" id="loginOut">退出当前用户:</a></li>
                    <li><a href="displayUser" class="usernamedisplay"></a></li>
                    <li class="displaylogin"><a href="#" data-toggle="modal"
                                                data-target="#login-modal">登录</a></li>
                    <li class="displaylogin"><a href="#" data-toggle="modal"
                                                data-target="#register-modal">注册</a></li>
                </ul>
            </div>
        </div>
    </div>
</nav>
<!--轮播-->
<div class="carousel slide" data-ride="carousel" data-interval="5000"
     data-pause="false" id="slideshow">
    <ol class="carousel-indicators">
        <li data-target="#slideshow" data-slide-to="0" class="active"></li>
        <li data-target="#slideshow" data-slide-to="1"></li>
        <li data-target="#slideshow" data-slide-to="2"></li>
        <li data-target="#slideshow" data-slide-to="3"></li>
        <li data-target="#slideshow" data-slide-to="4"></li>
        <li data-target="#slideshow" data-slide-to="5"></li>
    </ol>
    <div class="carousel-inner">
        <div class="item active">
            <img src="images/lunbo1.png" alt="">
            <div class="carousel-caption">
                <h2>我的毕业设计</h2>
                <p>当你想要放弃的时候，想想当初为什么坚持到这儿！</p>
            </div>
        </div>
        <div class="item">
            <img src="images/lunbo2.png" alt="">
            <div class="carousel-caption">
                <h2>我的毕业设计</h2>
                <p>当你想要放弃的时候，想想当初为什么坚持到这儿！</p>
            </div>
        </div>

        <div class="item">
            <img src="images/lunbo3.png" alt="">
            <div class="carousel-caption">
                <h2>我的毕业设计</h2>
                <p>当你想要放弃的时候，想想当初为什么坚持到这儿！</p>
            </div>
        </div>
        <div class="item">
            <img src="images/lunbo4.png" alt="">
            <div class="carousel-caption">
                <h2>我的毕业设计</h2>
                <p>当你想要放弃的时候，想想当初为什么坚持到这儿！</p>
            </div>
        </div>
        <div class="item">
            <img src="images/lunbo5.png" alt="">
            <div class="carousel-caption">
                <h2>我的毕业设计</h2>
                <p>当你想要放弃的时候，想想当初为什么坚持到这儿！</p>
            </div>
        </div>
        <div class="item">
            <img src="images/lunbo6.png" alt="">
            <div class="carousel-caption">
                <h2>我的毕业设计</h2>
                <p>当你想要放弃的时候，想想当初为什么坚持到这儿！</p>
            </div>
        </div>
    </div>
    <a href="#slideshow" data-slide="prev" class="left carousel-control">
        <span class="glyphicon glyphicon-chevron-left"></span>
    </a> <a href="#slideshow" data-slide="next" class="right carousel-control">
    <span class="glyphicon glyphicon-chevron-right"></span>
</a>
</div>
<!--//登录-->
<div class="modal fade login-modal" id="login-modal" tabindex="-1">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <div class="modal-header">
                <button class="close" data-dismiss="modal">&times;</button>
                <h4>
                    <b>用户登录</b>
                </h4>
            </div>
            <div class="modal-body">
                <div>
                    <!--<form method="post">-->
                    <div class="form-group">
                        <label for="username">Username <!--<span
                                class="glyphicon glyphicon-user"></span> --><input type="text"
                                                                                   name="username" class="form-control"
                                                                                   id="username"
                                                                                   placeholder="输入用户名"
                                                                                   style="padding-left: 22px"></label>
                    </div>
                    <div class="form-group">
                        <label for="password">Password <!--<span
                                class="glyphicon glyphicon-lock"></span> --><input type="password"
                                                                                   name="password" class="form-control"
                                                                                   id="password"
                                                                                   placeholder="输入密码"
                                                                                   style="padding-left: 22px"></label>
                    </div>
                    <div class="modal-footer">
                        <input type="submit" class="btn btn-group-xs" id="userLogin" value="login">
                        <!--<button onclick="loginUser()" class="btn btn-group-xs">login</button>-->
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!--//注册-->
<div class="modal fade login-modal" id="register-modal" tabindex="-1">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <div class="modal-header">
                <button class="close" data-dismiss="modal">&times;</button>
                <h4>
                    <b>用户注册</b>
                </h4>
            </div>
            <div class="modal-body">
                <div id="form2">
                    <div class="form-group">
                        <label for="username">Username <input type="text"
                                                              name="username" class="form-control"
                                                              id="rusername"
                                                              placeholder="输入用户名"
                                                              style="padding-left: 22px"></label>
                    </div>
                    <div class="form-group">
                        <label for="password">Password
                            <input type="password"
                                   name="password" class="form-control"
                                   id="rpassword"
                                   placeholder="输入密码"
                                   style="padding-left: 22px"></label>
                    </div>
                    <div class="modal-footer">
                        <button type="submit" class="btn btn-group-xs" id="userRegister">注册</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
<script type="text/javascript">
    $(function () {

        //申明localstorage
        var storage=window.localStorage;
        //从localstorage获得用户信息
        $(".usernamedisplay").text(storage.getItem("username"));
        //刷新当前用户
        setInterval(function () {
            displayuser();
        },1000);

        //登陆成功后隐藏登录注册按钮
        function displayuser() {
            a = $(".usernamedisplay").text();
            if (a!="") {
               /* $(".displaylogin").css('display', 'none');
                $(".nowuser").css('display', 'block');*/
                $(".displaylogin").fadeOut(1000);
                $(".nowuser").fadeIn(2000);
            }
        }

        //登录
        $("#userLogin").on("click", function () {
            $.ajax({
                url: "/login" ,//url
                type: "POST",//方法类型
                dataType: "json",//预期服务器返回的数据类型
                data: {username:$("#username").val(),password:$("#password").val()},
                success: function (res) {
                    storage.setItem("username",res.username);
                    storage.setItem("id",res.id);
                    storage.setItem("type",res.type);
                    window.location.reload(); //刷新当前页面
                },
                error : function() {
                    alert("登录失败！");
                }
            });
        });

        //注册
        $("#userRegister").on("click",function () {
            $.ajax({
                url:"/register",
                type:"POST",
                dataType:"json",
                data: {username:$("#rusername").val(),password:$("#rpassword").val()},
                success :function(res) {
                    alert("注册成功");
                    storage.setItem("username",res.username);
                    storage.setItem("id",res.id);
                    storage.setItem("type",res.type);
                    window.location.reload(); //刷新当前页面
                },error : function() {
                    alert("注册失败！");
                }

            });
        });
        //退出登录
        $("#loginOut").on("click",function () {
            localStorage.removeItem("username");
            localStorage.removeItem("id");
            localStorage.removeItem("type");
            window.location.reload(); //刷新当前页面
        });
        //显示\隐藏题库
        itemdisplay();
        function itemdisplay() {
            if(storage.getItem("type")==1){
                $(".itemdisplay").fadeIn(2000);
            }
        }
    })
</script>
</html>